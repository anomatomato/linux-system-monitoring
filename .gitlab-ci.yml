stages:
  - build

before_script:
  - apt-get update && apt-get install -y cmake build-essentials git bash
  - git clone https://github.com/eclipse/paho.mqtt.c.git
  - cd paho.mqtt.c
  - mkdir build
  - cd build
  - cmake -DCMAKE_INSTALL_PREFIX=/usr/local/paho-mqtt ..
  - make
  - make install
  - cd ../..

build:
    stage: build
    image: ubuntu:latest #arm32v7/debian:latest # Simulate an ARM environment similar to Raspberry Pi OS Lite.
    allow_failure: false
    when: always
    artifacts:
      paths:
          - .
      expire_in: 1 week

    script:
      - mkdir -p build && cd build
      - cmake ..
      - make